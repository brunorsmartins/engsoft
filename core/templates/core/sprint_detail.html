{% extends 'core/base.html' %}

{% block title %}Detalhes da Sprint{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header bg-primary text-white">
        Detalhes da Sprint: {{ sprint.nome }}
    </div>
    <div class="card-body">
        <p><strong>Descrição:</strong> {{ sprint.descricao }}</p>
        <p><strong>Data de Início:</strong> {{ sprint.data_inicio|date:"d/m/Y" }}</p>
        <p><strong>Data de Fim:</strong> {{ sprint.data_fim|date:"d/m/Y" }}</p>
        <p><strong>Gerente:</strong> {{ sprint.gerente.username }}</p>
    </div>
</div>

<div class="mt-4">
    <h4>Adicionar Daily</h4>
    <form method="POST" class="row g-3">
        {% csrf_token %}
        <div class="col-md-6">
            {{ daily_form.descricao.label_tag }}
            {{ daily_form.descricao|add_class:"form-control" }}
        </div>
        <div class="col-md-3">
            {{ daily_form.data.label_tag }}
            {{ daily_form.data|add_class:"form-control" }}
        </div>
        <div class="col-md-3">
            {{ daily_form.nota.label_tag }}
            {{ daily_form.nota|add_class:"form-control" }}
        </div>
        <div class="col-md-12">
            <button type="submit" class="btn btn-primary">Adicionar Daily</button>
        </div>
    </form>
</div>

<div class="mt-4">
    <h4>Notas da Sprint</h4>
    <p>A média das notas das Dailys: 
        <strong>{{ media_notas|default:"N/A"|floatformat:2 }}/100</strong>
    </p>
    <p>Média Geral da Sprint: 
        <strong>{{ sprint.calcular_media|default:"N/A"|floatformat:2 }}/100</strong>
    </p>
</div>

<div class="mt-4">
    <h4>Dailys</h4>
    <ul class="list-group">
        {% for daily in dailys %}
            <li class="list-group-item">
                <strong>{{ daily.data|date:"d/m/Y" }}</strong>: {{ daily.descricao }} 
                (Nota: {{ daily.nota }})
            </li>
        {% empty %}
            <li class="list-group-item">Nenhuma Daily registrada.</li>
        {% endfor %}
    </ul>
</div>

<div class="mt-4">
    <form method="POST" onsubmit="return confirm('Tem certeza que deseja deletar esta Sprint?');">
        {% csrf_token %}
        <button type="submit" name="delete" class="btn btn-danger">Deletar Sprint</button>
        <a href="{% url 'sprint_list' %}" class="btn btn-secondary">Voltar</a>
    </form>
</div>
{% endblock %}

